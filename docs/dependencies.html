<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Dependencies | R package workshop</title>
  <meta name="description" content="<p>These are the materials for the R package development workshop created by
COMBINE, an association for Australian students in bioinformatics,
computational biology and related fields.</p>
This workshop explains the basics of R package development and takes you
through the steps to create a minimal R package." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Dependencies | R package workshop" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>These are the materials for the R package development workshop created by
COMBINE, an association for Australian students in bioinformatics,
computational biology and related fields.</p>
This workshop explains the basics of R package development and takes you
through the steps to create a minimal R package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Dependencies | R package workshop" />
  
  <meta name="twitter:description" content="<p>These are the materials for the R package development workshop created by
COMBINE, an association for Australian students in bioinformatics,
computational biology and related fields.</p>
This workshop explains the basics of R package development and takes you
through the steps to create a minimal R package." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="testing.html">
<link rel="next" href="other-documentation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R package development workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-this-workshop"><i class="fa fa-check"></i>About this workshop</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#requirements"><i class="fa fa-check"></i>Requirements</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-and-rstudio"><i class="fa fa-check"></i>R and RStudio</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#packages"><i class="fa fa-check"></i>Packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#github"><i class="fa fa-check"></i>GitHub</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-a-package"><i class="fa fa-check"></i><b>1.1</b> What is a package?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#why-write-a-package"><i class="fa fa-check"></i><b>1.2</b> Why write a package?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#packages-for-writing-packages"><i class="fa fa-check"></i><b>1.2.1</b> Packages for writing packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="setting-up.html"><a href="setting-up.html"><i class="fa fa-check"></i><b>2</b> Setting up</a><ul>
<li class="chapter" data-level="2.1" data-path="setting-up.html"><a href="setting-up.html#open-rstudio"><i class="fa fa-check"></i><b>2.1</b> Open RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="setting-up.html"><a href="setting-up.html#naming-your-package"><i class="fa fa-check"></i><b>2.2</b> Naming your package</a></li>
<li class="chapter" data-level="2.3" data-path="setting-up.html"><a href="setting-up.html#creating-your-package"><i class="fa fa-check"></i><b>2.3</b> Creating your package</a></li>
<li class="chapter" data-level="2.4" data-path="setting-up.html"><a href="setting-up.html#filling-in-the-description"><i class="fa fa-check"></i><b>2.4</b> Filling in the DESCRIPTION</a><ul>
<li class="chapter" data-level="2.4.1" data-path="setting-up.html"><a href="setting-up.html#title-and-description"><i class="fa fa-check"></i><b>2.4.1</b> Title and description</a></li>
<li class="chapter" data-level="2.4.2" data-path="setting-up.html"><a href="setting-up.html#authors"><i class="fa fa-check"></i><b>2.4.2</b> Authors</a></li>
<li class="chapter" data-level="2.4.3" data-path="setting-up.html"><a href="setting-up.html#license-1"><i class="fa fa-check"></i><b>2.4.3</b> License</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3</b> Functions</a><ul>
<li class="chapter" data-level="3.1" data-path="functions.html"><a href="functions.html#adding-a-function"><i class="fa fa-check"></i><b>3.1</b> Adding a function</a></li>
<li class="chapter" data-level="3.2" data-path="functions.html"><a href="functions.html#using-the-function"><i class="fa fa-check"></i><b>3.2</b> Using the function</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="checking-you-package.html"><a href="checking-you-package.html"><i class="fa fa-check"></i><b>4</b> Checking you package</a></li>
<li class="chapter" data-level="5" data-path="documenting-functions.html"><a href="documenting-functions.html"><i class="fa fa-check"></i><b>5</b> Documenting functions</a><ul>
<li class="chapter" data-level="5.1" data-path="documenting-functions.html"><a href="documenting-functions.html#adding-documentation"><i class="fa fa-check"></i><b>5.1</b> Adding documentation</a></li>
<li class="chapter" data-level="5.2" data-path="documenting-functions.html"><a href="documenting-functions.html#building-documentation"><i class="fa fa-check"></i><b>5.2</b> Building documentation</a></li>
<li class="chapter" data-level="5.3" data-path="documenting-functions.html"><a href="documenting-functions.html#formatting-documentation"><i class="fa fa-check"></i><b>5.3</b> Formatting documentation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="testing.html"><a href="testing.html"><i class="fa fa-check"></i><b>6</b> Testing</a></li>
<li class="chapter" data-level="7" data-path="dependencies.html"><a href="dependencies.html"><i class="fa fa-check"></i><b>7</b> Dependencies</a></li>
<li class="chapter" data-level="8" data-path="other-documentation.html"><a href="other-documentation.html"><i class="fa fa-check"></i><b>8</b> Other documentation</a><ul>
<li class="chapter" data-level="8.1" data-path="other-documentation.html"><a href="other-documentation.html#package-help-file"><i class="fa fa-check"></i><b>8.1</b> Package help file</a></li>
<li class="chapter" data-level="8.2" data-path="other-documentation.html"><a href="other-documentation.html#vignettes"><i class="fa fa-check"></i><b>8.2</b> Vignettes</a></li>
<li class="chapter" data-level="8.3" data-path="other-documentation.html"><a href="other-documentation.html#readme"><i class="fa fa-check"></i><b>8.3</b> README</a></li>
<li class="chapter" data-level="8.4" data-path="other-documentation.html"><a href="other-documentation.html#package-website"><i class="fa fa-check"></i><b>8.4</b> Package website</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="versioning.html"><a href="versioning.html"><i class="fa fa-check"></i><b>9</b> Versioning</a></li>
<li class="chapter" data-level="10" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html"><i class="fa fa-check"></i><b>10</b> Building, installing and releasing</a><ul>
<li class="chapter" data-level="10.1" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html#building"><i class="fa fa-check"></i><b>10.1</b> Building</a></li>
<li class="chapter" data-level="10.2" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html#official-repositories"><i class="fa fa-check"></i><b>10.2</b> Official repositories</a><ul>
<li class="chapter" data-level="10.2.1" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html#cran"><i class="fa fa-check"></i><b>10.2.1</b> CRAN</a></li>
<li class="chapter" data-level="10.2.2" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html#bioconductor"><i class="fa fa-check"></i><b>10.2.2</b> Bioconductor</a></li>
<li class="chapter" data-level="10.2.3" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html#ropensci"><i class="fa fa-check"></i><b>10.2.3</b> rOpenSci</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html#code-sharing-websites"><i class="fa fa-check"></i><b>10.3</b> Code sharing websites</a><ul>
<li class="chapter" data-level="10.3.1" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html#set-up-git"><i class="fa fa-check"></i><b>10.3.1</b> Set up git</a></li>
<li class="chapter" data-level="10.3.2" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html#connect-to-github"><i class="fa fa-check"></i><b>10.3.2</b> Connect to GitHub</a></li>
<li class="chapter" data-level="10.3.3" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html#installing-from-github"><i class="fa fa-check"></i><b>10.3.3</b> Installing from GitHub</a></li>
<li class="chapter" data-level="10.3.4" data-path="building-installing-and-releasing.html"><a href="building-installing-and-releasing.html#updating-github"><i class="fa fa-check"></i><b>10.3.4</b> Updating GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="advanced-topics.html"><a href="advanced-topics.html"><i class="fa fa-check"></i><b>11</b> Advanced topics</a><ul>
<li class="chapter" data-level="11.1" data-path="advanced-topics.html"><a href="advanced-topics.html#including-datasets"><i class="fa fa-check"></i><b>11.1</b> Including datasets</a></li>
<li class="chapter" data-level="11.2" data-path="advanced-topics.html"><a href="advanced-topics.html#designing-objects"><i class="fa fa-check"></i><b>11.2</b> Designing objects</a></li>
<li class="chapter" data-level="11.3" data-path="advanced-topics.html"><a href="advanced-topics.html#integrating-other-languages"><i class="fa fa-check"></i><b>11.3</b> Integrating other languages</a></li>
<li class="chapter" data-level="11.4" data-path="advanced-topics.html"><a href="advanced-topics.html#metaprogramming"><i class="fa fa-check"></i><b>11.4</b> Metaprogramming</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="good-practices-and-advice.html"><a href="good-practices-and-advice.html"><i class="fa fa-check"></i><b>12</b> Good practices and advice</a><ul>
<li class="chapter" data-level="12.1" data-path="good-practices-and-advice.html"><a href="good-practices-and-advice.html#design-advice"><i class="fa fa-check"></i><b>12.1</b> Design advice</a></li>
<li class="chapter" data-level="12.2" data-path="good-practices-and-advice.html"><a href="good-practices-and-advice.html#coding-style"><i class="fa fa-check"></i><b>12.2</b> Coding style</a></li>
<li class="chapter" data-level="12.3" data-path="good-practices-and-advice.html"><a href="good-practices-and-advice.html#version-control"><i class="fa fa-check"></i><b>12.3</b> Version control</a></li>
<li class="chapter" data-level="12.4" data-path="good-practices-and-advice.html"><a href="good-practices-and-advice.html#continuous-integration"><i class="fa fa-check"></i><b>12.4</b> Continuous integration</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i>Resources</a><ul>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#official-guides"><i class="fa fa-check"></i>Official guides</a><ul>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#cran-1"><i class="fa fa-check"></i>CRAN</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#bioconductor-1"><i class="fa fa-check"></i>Bioconductor</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#ropensci-1"><i class="fa fa-check"></i>rOpenSci</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#rstudio"><i class="fa fa-check"></i>RStudio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#books"><i class="fa fa-check"></i>Books</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#tutorials"><i class="fa fa-check"></i>Tutorials</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#workshops-and-courses"><i class="fa fa-check"></i>Workshops and courses</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#blogs"><i class="fa fa-check"></i>Blogs</a></li>
<li class="chapter" data-level="" data-path="resources.html"><a href="resources.html#style"><i class="fa fa-check"></i>Style</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R package workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dependencies" class="section level1">
<h1><span class="header-section-number">7</span> Dependencies</h1>
<p>Our <code>make_shades()</code> function produces shades of a colour but it would be good
to see what those look like. Below is a new function called <code>plot_colours()</code>
that can visualise them for us using <strong>ggplot2</strong> (if you don’t have <strong>ggplot2</strong>
installed do that now). Add this function to <code>colours.R</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co">#&#39; Plot colours</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="co">#&#39; Plot a vector of colours to see what they look like</span></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="co">#&#39; </span></a>
<a class="sourceLine" id="cb45-5" title="5"><span class="co">#&#39; @param colours Vector of colour to plot</span></a>
<a class="sourceLine" id="cb45-6" title="6"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb45-7" title="7"><span class="co">#&#39; @return A ggplot2 object</span></a>
<a class="sourceLine" id="cb45-8" title="8"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb45-9" title="9"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb45-10" title="10"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb45-11" title="11"><span class="co">#&#39; shades &lt;- make_shades(&quot;goldenrod&quot;, 5)</span></a>
<a class="sourceLine" id="cb45-12" title="12"><span class="co">#&#39; plot_colours(shades)</span></a>
<a class="sourceLine" id="cb45-13" title="13">plot_colours &lt;-<span class="st"> </span><span class="cf">function</span>(colours) {</a>
<a class="sourceLine" id="cb45-14" title="14">    plot_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Colour =</span> colours)</a>
<a class="sourceLine" id="cb45-15" title="15">    </a>
<a class="sourceLine" id="cb45-16" title="16">    <span class="kw">ggplot</span>(plot_data,</a>
<a class="sourceLine" id="cb45-17" title="17">           <span class="kw">aes</span>(<span class="dt">x =</span> .data<span class="op">$</span>Colour, <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">fill =</span> .data<span class="op">$</span>Colour,</a>
<a class="sourceLine" id="cb45-18" title="18">               <span class="dt">label =</span> .data<span class="op">$</span>Colour)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-19" title="19"><span class="st">        </span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb45-20" title="20"><span class="st">        </span><span class="kw">geom_text</span>(<span class="dt">angle =</span> <span class="st">&quot;90&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-21" title="21"><span class="st">        </span><span class="kw">scale_fill_identity</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb45-22" title="22"><span class="st">        </span><span class="kw">theme_void</span>()</a>
<a class="sourceLine" id="cb45-23" title="23">}</a></code></pre></div>
<p>Now that we have added something new we should run our checks again
(<code>devtools::document()</code> is automatically run as part of <code>devtools::check()</code> so
we can skip that step).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">devtools<span class="op">::</span><span class="kw">check</span>()</a></code></pre></div>
<pre><code>-- R CMD check results ------------------------------------------- mypkg 0.0.0.9000 ----
Duration: 15.4s

&gt; checking examples ... ERROR
  Running examples in &#39;mypkg-Ex.R&#39; failed
  The error most likely occurred in:
  
  &gt; base::assign(&quot;.ptime&quot;, proc.time(), pos = &quot;CheckExEnv&quot;)
  &gt; ### Name: plot_colours
  &gt; ### Title: Plot colours
  &gt; ### Aliases: plot_colours
  &gt; 
  &gt; ### ** Examples
  &gt; 
  &gt; shades &lt;- make_shades(&quot;goldenrod&quot;, 5)
  &gt; plot_colours(shades)
  Error in ggplot(plot_data, aes(x = .data$Colour, y = 1, fill = .data$Colour,  : 
    could not find function &quot;ggplot&quot;
  Calls: plot_colours
  Execution halted

&gt; checking R code for possible problems ... NOTE
  plot_colours: no visible global function definition for &#39;ggplot&#39;
  plot_colours: no visible global function definition for &#39;aes&#39;
  plot_colours: no visible binding for global variable &#39;.data&#39;
  plot_colours: no visible global function definition for &#39;geom_tile&#39;
  plot_colours: no visible global function definition for &#39;geom_text&#39;
  plot_colours: no visible global function definition for
    &#39;scale_fill_identity&#39;
  plot_colours: no visible global function definition for &#39;theme_void&#39;
  Undefined global functions or variables:
    .data aes geom_text geom_tile ggplot scale_fill_identity theme_void
    
1 error x | 0 warnings √ | 1 note x</code></pre>
<p>The checks have returned one error and one note. The error is more serious so
let’s have a look at that first. It says <code>could not find function "ggplot"</code>.
Hmmmm…the <code>ggplot()</code> function is in the <strong>ggplot2</strong> package. When we used
<code>col2rgb()</code> in the <code>make_shades()</code> function we had to prefix it with
<code>grDevices::</code>, maybe we should do the same here.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co">#&#39; Plot colours</span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co">#&#39; Plot a vector of colours to see what they look like</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="co">#&#39; </span></a>
<a class="sourceLine" id="cb48-5" title="5"><span class="co">#&#39; @param colours Vector of colour to plot</span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb48-7" title="7"><span class="co">#&#39; @return A ggplot2 object</span></a>
<a class="sourceLine" id="cb48-8" title="8"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb48-9" title="9"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb48-10" title="10"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb48-11" title="11"><span class="co">#&#39; shades &lt;- make_shades(&quot;goldenrod&quot;, 5)</span></a>
<a class="sourceLine" id="cb48-12" title="12"><span class="co">#&#39; plot_colours(shades)</span></a>
<a class="sourceLine" id="cb48-13" title="13">plot_colours &lt;-<span class="st"> </span><span class="cf">function</span>(colours) {</a>
<a class="sourceLine" id="cb48-14" title="14">    plot_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Colour =</span> colours)</a>
<a class="sourceLine" id="cb48-15" title="15">    </a>
<a class="sourceLine" id="cb48-16" title="16">    ggplot2<span class="op">::</span><span class="kw">ggplot</span>(plot_data,</a>
<a class="sourceLine" id="cb48-17" title="17">                    ggplot2<span class="op">::</span><span class="kw">aes</span>(<span class="dt">x =</span> .data<span class="op">$</span>Colour, <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">fill =</span> .data<span class="op">$</span>Colour,</a>
<a class="sourceLine" id="cb48-18" title="18">                                 <span class="dt">label =</span> .data<span class="op">$</span>Colour)) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-19" title="19"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb48-20" title="20"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">geom_text</span>(<span class="dt">angle =</span> <span class="st">&quot;90&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb48-21" title="21"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">scale_fill_identity</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb48-22" title="22"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">theme_void</span>()</a>
<a class="sourceLine" id="cb48-23" title="23">}</a></code></pre></div>
<p>Now what do our checks say?</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">devtools<span class="op">::</span><span class="kw">check</span>()</a></code></pre></div>
<pre><code>-- R CMD check results ------------------------------------------ mypkg 0.0.0.9000 ----
Duration: 15s

&gt; checking examples ... ERROR
  Running examples in &#39;mypkg-Ex.R&#39; failed
  The error most likely occurred in:
  
  &gt; base::assign(&quot;.ptime&quot;, proc.time(), pos = &quot;CheckExEnv&quot;)
  &gt; ### Name: plot_colours
  &gt; ### Title: Plot colours
  &gt; ### Aliases: plot_colours
  &gt; 
  &gt; ### ** Examples
  &gt; 
  &gt; shades &lt;- make_shades(&quot;goldenrod&quot;, 5)
  &gt; plot_colours(shades)
  Error in loadNamespace(name) : there is no package called &#39;ggplot2&#39;
  Calls: plot_colours ... loadNamespace -&gt; withRestarts -&gt; withOneRestart -&gt; doWithOneRestart
  Execution halted

&gt; checking dependencies in R code ... WARNING
  &#39;::&#39; or &#39;:::&#39; import not declared from: &#39;ggplot2&#39;

&gt; checking R code for possible problems ... NOTE
  plot_colours: no visible binding for global variable &#39;.data&#39;
  Undefined global functions or variables:
    .data

1 error x | 1 warning x | 1 note x</code></pre>
<p>There is now one error, one warning and one note. That seems like we are going
in the wrong direction but the error is from running the example and the
warning gives us a clue to what the problem is. It says “‘::’ or ‘:::’ import
not declared from: ‘ggplot2’”. The important word here is “import”. Just like
when we export a function in our package we need to make it clear when we are
using functions in another package. To do this we can use
<code>usethis::use_package()</code>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">usethis<span class="op">::</span><span class="kw">use_package</span>(<span class="st">&quot;ggplot2&quot;</span>)</a></code></pre></div>
<pre><code>✔ Setting active project to &#39;C:/Users/Luke/Desktop/mypkg&#39;
✔ Adding &#39;ggplot2&#39; to Imports field in DESCRIPTION
● Refer to functions with `ggplot2::fun()`</code></pre>
<p>The output tells us to refer to functions using “::” like we did above so we
were on the right track. It also mentions that it has modified the <code>DESCRIPTION</code>
file. Let’s have a look at it now.</p>
<pre><code>Package: mypkg
Title: My Personal Package
Version: 0.0.0.9000
Authors@R: c(
    person(given = &quot;Package&quot;,
           family = &quot;Creator&quot;,
           role = c(&quot;aut&quot;, &quot;cre&quot;),
           email = &quot;package.creator@mypkg.com&quot;),
    person(given = &quot;Package&quot;,
           family = &quot;Contributor&quot;,
           role = c(&quot;ctb&quot;),
           email = &quot;package.contributor@mypkg.com&quot;)
    )
Description: This is my personal package. It contains some handy functions that
    I find useful for my projects.
License: MIT + file LICENSE
Encoding: UTF-8
LazyData: true
RoxygenNote: 6.1.1
Suggests: 
    testthat (&gt;= 2.1.0)
Imports: 
    ggplot2</code></pre>
<p>The two lines at the bottom tell us that our package uses functions in
<strong>ggplot2</strong>. There are three main types of dependencies<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. Imports is the most common. This
means that we use functions from these packages and they must be installed when
our package is installed. The next most common is Suggests. These are packages
that we use in developing our package (such as <strong>testthat</strong> which is already
listed here) or packages that provide some additional, optional functionality.
Suggested packages aren’t usually installed so we need to do a check before we
use them. The output of <code>usethis::use_package()</code> will give you an example if
you add a suggested package. The third type of dependency is Depends. If you
depend on a package it will be loaded whenever your package is loaded. There are
some cases where you might need to do this but you should avoid Depends unless
it is absolutely necessary.</p>
<blockquote>
<p><strong>Should you use a dependency?</strong></p>
<p>Deciding which packages (and how many) to depend on is a difficult and
philosophical choice. Using functions from other packages can save you time
and effort in development but it might make it more difficult to maintain
your package. Some things you might want to consider before depending on a
package are:</p>
<ul>
<li>How much of the functionality of the package do you want to use?</li>
<li>Could you easily reproduce that functionality?</li>
<li>How well maintained is the package?</li>
<li>How often is it updated? Packages that change a lot are more likely to
break your code.</li>
<li>How many dependencies of it’s own does that package have?</li>
<li>Are you users likely to have the package installed already?</li>
</ul>
<p>Packages like <strong>ggplot2</strong> are good choices for dependencies because they are
well maintained, don’t change too often, are commonly used and perform a
single task so you are likely to use many of the functions.</p>
</blockquote>
<p>Hopefully now that we have imported <strong>ggplot2</strong> we should pass the checks.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">devtools<span class="op">::</span><span class="kw">check</span>()</a></code></pre></div>
<pre><code>-- R CMD check results ------------------------------------------ mypkg 0.0.0.9000 ----
Duration: 16.4s

&gt; checking R code for possible problems ... NOTE
  plot_colours: no visible binding for global variable &#39;.data&#39;
  Undefined global functions or variables:
    .data

0 errors √ | 0 warnings √ | 1 note x</code></pre>
<p>Success! Now all that’s left is that pesky note. Visualisation functions are
probably some of the most common functions in packages but there are some
tricks to programming with <strong>ggplot2</strong>. The details are outside the scope of
this workshop but if you are interested see the “Using ggplot2 in packages”
vignette <a href="https://ggplot2.tidyverse.org/dev/articles/ggplot2-in-packages.html" class="uri">https://ggplot2.tidyverse.org/dev/articles/ggplot2-in-packages.html</a>.</p>
<p>To solve our problem we need to import the <strong>rlang</strong> package.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">usethis<span class="op">::</span><span class="kw">use_package</span>(<span class="st">&quot;rlang&quot;</span>)</a></code></pre></div>
<pre><code>✔ Adding &#39;rlang&#39; to Imports field in DESCRIPTION
● Refer to functions with `rlang::fun()`</code></pre>
<p>Writing <code>rlang::.data</code> wouldn’t be very attractive or readable<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>. When we want to use a function
in another package with <code>::</code> we need to exlicitly import it. Just like when we
exported our functions we do this using a Roxygen comment.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co">#&#39; Plot colours</span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb58-3" title="3"><span class="co">#&#39; Plot a vector of colours to see what they look like</span></a>
<a class="sourceLine" id="cb58-4" title="4"><span class="co">#&#39; </span></a>
<a class="sourceLine" id="cb58-5" title="5"><span class="co">#&#39; @param colours Vector of colour to plot</span></a>
<a class="sourceLine" id="cb58-6" title="6"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb58-7" title="7"><span class="co">#&#39; @return A ggplot2 object</span></a>
<a class="sourceLine" id="cb58-8" title="8"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb58-9" title="9"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb58-10" title="10"><span class="co">#&#39; @importFrom rlang .data</span></a>
<a class="sourceLine" id="cb58-11" title="11"><span class="co">#&#39; </span></a>
<a class="sourceLine" id="cb58-12" title="12"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb58-13" title="13"><span class="co">#&#39; shades &lt;- make_shades(&quot;goldenrod&quot;, 5)</span></a>
<a class="sourceLine" id="cb58-14" title="14"><span class="co">#&#39; plot_colours(shades)</span></a>
<a class="sourceLine" id="cb58-15" title="15">plot_colours &lt;-<span class="st"> </span><span class="cf">function</span>(colours) {</a>
<a class="sourceLine" id="cb58-16" title="16">    plot_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Colour =</span> colours)</a>
<a class="sourceLine" id="cb58-17" title="17">    </a>
<a class="sourceLine" id="cb58-18" title="18">    ggplot2<span class="op">::</span><span class="kw">ggplot</span>(plot_data,</a>
<a class="sourceLine" id="cb58-19" title="19">                    ggplot2<span class="op">::</span><span class="kw">aes</span>(<span class="dt">x =</span> .data<span class="op">$</span>Colour, <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">fill =</span> .data<span class="op">$</span>Colour,</a>
<a class="sourceLine" id="cb58-20" title="20">                                 <span class="dt">label =</span> .data<span class="op">$</span>Colour)) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-21" title="21"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb58-22" title="22"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">geom_text</span>(<span class="dt">angle =</span> <span class="st">&quot;90&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-23" title="23"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">scale_fill_identity</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb58-24" title="24"><span class="st">        </span>ggplot2<span class="op">::</span><span class="kw">theme_void</span>()</a>
<a class="sourceLine" id="cb58-25" title="25">}</a></code></pre></div>
<p>When we use <code>devtools::document()</code> this comment will be read and a note placed
in the <code>NAMESPACE</code> file, just like for <code>@export</code>.</p>
<pre><code># Generated by roxygen2: do not edit by hand

export(make_shades)
export(plot_colours)
importFrom(rlang,.data)</code></pre>
<p>Those two steps should fix our note.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">devtools<span class="op">::</span><span class="kw">check</span>()</a></code></pre></div>
<pre><code>-- R CMD check results ------------------------------------------ mypkg 0.0.0.9000 ----
Duration: 16.8s

0 errors √ | 0 warnings √ | 0 notes √</code></pre>
<p>If we used <code>rlang::.data</code> in multiple functions in our pacakge it might make
sense to only import it once. It doesn’t matter where we put the <code>@importFrom</code>
line (or how many times) it will still be added to <code>NAMESPACE</code>. This means we
can put all import in a central location. The advantage of this is that they
only appear once and are all in one place but it makes it harder to know which
of our functions have which imports and remove them if they are no longer
needed. Which approach you take is up to you.</p>
<p>We should write some tests for this function as well but we will leave that
as an exercise for you to try later.</p>

</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>There is a fourth kind
(Enhances) but that is almost never used.<a href="dependencies.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Also for
technical reasons it won’t work in this case.<a href="dependencies.html#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="testing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="other-documentation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/COMBINE-Australia/r-pkg-dev/edit/master/07-dependencies.Rmd",
"text": "Edit"
},
"history": {
"link": "https://github.com/COMBINE-Australia/r-pkg-dev/commits/master/07-dependencies.Rmd",
"text": null
},
"download": ["r-pkg-dev.pdf", "r-pkg-dev.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
